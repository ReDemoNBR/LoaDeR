<script>
window.onload = AlterOnLoad;
window.onunload = CloseWindow;

var Row;
var Token;
var Checker = "";

function AlterOnLoad(){
  GetRowParameter();
  GetTokenParameter();
  document.write("<object id='HGTestVersion' data='http://test.heroesandgenerals.com' style='left:0px; top:0px; margin-left:0px; margin-top:0px; position:fixed;'></object>");
  Checker = window.open("https://script.google.com/macros/s/AKfycby5U_ZWMloL8YBFliDWvAg6qbjcGSbCq1vn3G1BPNmo/dev?chk="+Token+"&Row="+Row, "Checker", "width=400, height=200");
  var Obj = document.getElementById("HGTestVersion");
  Obj.width = window.innerWidth;
  Obj.height = window.innerHeight;
  Checker.onload = function(){Status();};
  Status();
}


function Status(){
  if(Checker!="" && Checker.closed)
    CloseWindow();
  else setTimeout(Status, 30000);
}


function CloseWindow(){
  Checker.close();
  window.open("https://script.google.com/macros/s/AKfycby5U_ZWMloL8YBFliDWvAg6qbjcGSbCq1vn3G1BPNmo/dev?close="+Row, "_top");
}


function GetRowParameter(){
  var aux = location.search;
  aux = aux.substring(0, aux.indexOf("&"));
  Row = aux.replace("?Row=", "");
}


function GetTokenParameter(){
  var aux = location.search;
  aux = aux.substring(aux.indexOf("&"));
  Token = aux.replace("&Token=", "");
}
</script>
