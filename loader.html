<script>
window.onload = AlterOnLoad;
window.onunload = CloseWindow;

var Row;
var Token;
var Checker = "";
var MsgReceived = false;

function AlterOnLoad(){
  GetRowParameter();
  GetTokenParameter();
  //var CheckerURL = "https://script.google.com/macros/s/AKfycby5U_ZWMloL8YBFliDWvAg6qbjcGSbCq1vn3G1BPNmo/dev?chk="+Token+"&Row="+Row;
  var CheckerURL = "https://script.google.com/macros/s/AKfycbxSgPGQ8B6dzO2nragqmWqTIBKsTxmHtjgWe1mfOe2nHtkDtCA8/exec?chk="+Token+"&Row="+Row;
  Checker = window.open(CheckerURL, "_top");
  if(Checker.location.href == "about:blank"){
    if(Checker!=undefined && Checker!=null){
      console.log("Has Reference!");
    }
    else console.log("Lost");
    Checker.location.href = CheckerURL;
  }
  if(Checker!=undefined && Checker!=null){
    console.log("Still has reference");
  }
  else console.log("Disappeared");
}


function GetRowParameter(){
  var aux = location.search;
  aux = aux.substring(0, aux.indexOf("&"));
  Row = aux.replace("?Row=", "");
}


function GetTokenParameter(){
  var aux = location.search;
  aux = aux.substring(aux.indexOf("&"));
  Token = aux.replace("&Token=", "");
}
</script>
